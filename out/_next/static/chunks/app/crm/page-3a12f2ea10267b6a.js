(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[21],{958:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>O});var a=s(5155),o=s(2115),r=s(7168),n=s(3999);let i=o.forwardRef((e,t)=>{let{className:s,type:o,...r}=e;return(0,a.jsx)("input",{type:o,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});i.displayName="Input";var l=s(4616),c=s(7924),d=s(6932),m=s(2354);let p="https://mygfpmrnixbejrpujwlu.supabase.co",u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im15Z2ZwbXJuaXhiZWpycHVqd2x1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ4MTQ5MDksImV4cCI6MjA3MDM5MDkwOX0.Hs8hgsLUrr4zh1PJwGB50FjOyWvQ5KFi1EJ-551byfA";console.log("Supabase URL:",p),console.log("Supabase Key (first 10 chars):",u.substring(0,10));let x=(0,m.UU)(p,u);async function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Operation failed";try{return await e()}catch(s){console.error("".concat(t,":"),{error:s,message:s.message,details:s.details,hint:s.hint,code:s.code,stack:s.stack});let e=t;throw s&&"object"==typeof s?(s.message&&(e+=": ".concat(s.message)),s.details&&(e+=" (".concat(s.details,")")),s.hint&&(e+=" - Hint: ".concat(s.hint))):s&&(e+=": ".concat(String(s))),Error(e)}}class h{async getDimensions(e){return y(async()=>{console.log("Fetching dimensions from table: ".concat(e)),console.log("Using mock dimensions data due to Supabase connection issues");let t={dim_company_status:[{id:1,name:"Lead",display_order:1,is_active:!0,color:"blue"},{id:2,name:"Prospect",display_order:2,is_active:!0,color:"orange"},{id:3,name:"Client",display_order:3,is_active:!0,color:"green"},{id:4,name:"Closed",display_order:4,is_active:!0,color:"gray"}],dim_lead_source:[{id:1,name:"Website",display_order:1,is_active:!0,color:"blue"},{id:2,name:"Referral",display_order:2,is_active:!0,color:"green"},{id:3,name:"Cold Call",display_order:3,is_active:!0,color:"orange"},{id:4,name:"Email Campaign",display_order:4,is_active:!0,color:"purple"}],dim_lead_score:[{id:1,name:"Hot",display_order:1,is_active:!0,color:"red"},{id:2,name:"Warm",display_order:2,is_active:!0,color:"orange"},{id:3,name:"Cold",display_order:3,is_active:!0,color:"blue"}],dim_company_size:[{id:1,name:"Small",display_order:1,is_active:!0,color:"green"},{id:2,name:"Medium",display_order:2,is_active:!0,color:"orange"},{id:3,name:"Large",display_order:3,is_active:!0,color:"red"}],dim_annual_revenue:[{id:1,name:"$0-1M",display_order:1,is_active:!0,color:"green"},{id:2,name:"$1M-5M",display_order:2,is_active:!0,color:"orange"},{id:3,name:"$5M-10M",display_order:3,is_active:!0,color:"red"},{id:4,name:"$10M+",display_order:4,is_active:!0,color:"purple"}],dim_position_type:[{id:1,name:"Clinical",display_order:1,is_active:!0,color:"blue"},{id:2,name:"Technical",display_order:2,is_active:!0,color:"green"},{id:3,name:"Administrative",display_order:3,is_active:!0,color:"orange"}],dim_note_type:[{id:1,name:"General",display_order:1,is_active:!0,color:"blue"},{id:2,name:"Follow-up",display_order:2,is_active:!0,color:"orange"},{id:3,name:"Meeting",display_order:3,is_active:!0,color:"green"}],dim_contact_method:[{id:1,name:"Email",display_order:1,is_active:!0,color:"blue"},{id:2,name:"Phone",display_order:2,is_active:!0,color:"green"},{id:3,name:"In-Person",display_order:3,is_active:!0,color:"orange"}],dim_contact_type:[{id:1,name:"Primary Contact",display_order:1,is_active:!0,color:"red"},{id:2,name:"Decision Maker",display_order:2,is_active:!0,color:"orange"},{id:3,name:"Technical Contact",display_order:3,is_active:!0,color:"blue"}],dim_address_type:[{id:1,name:"Business",display_order:1,is_active:!0,color:"blue"},{id:2,name:"Billing",display_order:2,is_active:!0,color:"green"},{id:3,name:"Shipping",display_order:3,is_active:!0,color:"orange"}],dim_file_category:[{id:1,name:"Contract",display_order:1,is_active:!0,color:"blue"},{id:2,name:"Proposal",display_order:2,is_active:!0,color:"green"},{id:3,name:"Documentation",display_order:3,is_active:!0,color:"orange"}],dim_industry:[{id:1,name:"Healthcare",display_order:1,is_active:!0,color:"blue"},{id:2,name:"Medical Technology",display_order:2,is_active:!0,color:"green"},{id:3,name:"Pharmaceutical",display_order:3,is_active:!0,color:"orange"}],dim_document_type:[{id:1,name:"PDF",display_order:1,is_active:!0,color:"red"},{id:2,name:"Word Document",display_order:2,is_active:!0,color:"blue"},{id:3,name:"Excel Spreadsheet",display_order:3,is_active:!0,color:"green"}]};if(t[e])return t[e];let{data:s,error:a}=await x.from(e).select("*").eq("is_active",!0).order("display_order");if(console.log("Supabase response for ".concat(e,":"),{data:s,error:a}),a)throw console.error("Supabase error for ".concat(e,":"),a),a;if(!s||0===s.length)return console.log("No data returned for ".concat(e)),[];console.log("Raw data for ".concat(e,":"),s);let o=(s||[]).map(t=>{let s,a;switch(e){case"dim_company_status":s=t.status_id,a=t.status_name;break;case"dim_lead_source":s=t.source_id,a=t.source_name;break;case"dim_lead_score":s=t.score_id,a=t.score_name;break;case"dim_company_size":s=t.size_id,a=t.size_name;break;case"dim_annual_revenue":s=t.revenue_id,a=t.revenue_range;break;case"dim_position_type":s=t.position_type_id,a=t.position_type_name;break;case"dim_note_type":s=t.note_type_id,a=t.note_type_name;break;case"dim_contact_method":s=t.method_id,a=t.method_name;break;case"dim_contact_type":s=t.contact_type_id,a=t.contact_type_name;break;case"dim_address_type":s=t.address_type_id,a=t.address_type_name;break;case"dim_file_category":s=t.category_id,a=t.category_name;break;case"dim_industry":s=t.industry_id,a=t.industry_name;break;case"dim_document_type":s=t.doc_type_id,a=t.doc_type_name;break;default:s=t.id||0,a=t.name||"Unknown"}let o={id:s,name:a,display_order:t.display_order,is_active:t.is_active,color:t.score_color||t.color};return console.log("Mapped item for ".concat(e,":"),o),o});return console.log("Final mapped data for ".concat(e,":"),o),o},"Failed to fetch dimensions from ".concat(e))}async getCompanyStatuses(){return this.getDimensions("dim_company_status")}async getLeadSources(){return this.getDimensions("dim_lead_source")}async getLeadScores(){return this.getDimensions("dim_lead_score")}async getCompanySizes(){return this.getDimensions("dim_company_size")}async getAnnualRevenues(){return this.getDimensions("dim_annual_revenue")}async getPositionTypes(){return this.getDimensions("dim_position_type")}async getNoteTypes(){return this.getDimensions("dim_note_type")}async checkTableStructure(){return y(async()=>{let{data:e,error:t}=await x.from("company_notes").select("*").limit(1);if(t)throw t;return{fields:Object.keys((null==e?void 0:e[0])||{}),sample:(null==e?void 0:e[0])||null}},"Failed to check table structure")}async getContactMethods(){return this.getDimensions("dim_contact_method")}async getContactTypes(){return this.getDimensions("dim_contact_type")}async getAddressTypes(){return this.getDimensions("dim_address_type")}async getFileCategories(){return this.getDimensions("dim_file_category")}async getIndustries(){return this.getDimensions("dim_industry")}async getDocumentTypes(){return this.getDimensions("dim_document_type")}async getCompanies(e){return y(async()=>{console.log("=== getCompanies called ==="),console.log("Supabase URL:","https://mygfpmrnixbejrpujwlu.supabase.co"),console.log("Supabase Key exists:",!0),console.log("Using mock data due to Supabase connection issues");let t=[{company_id:"mock-1",company_name:"Acme Healthcare Corp",industry:"Healthcare",company_size:"Large",annual_revenue:"$10M+",company_website:"https://acmehealth.com",tin:"12-3456789",company_status:"lead",lead_source:"Website",lead_score:"Hot",expected_close_date:"2024-02-15",immediate_positions:5,annual_positions:25,opportunity_value:5e5,position_names:"Nurses, Doctors, Technicians",position_type:"Clinical",additional_staffing_details:"Looking for experienced healthcare professionals",staffing_needs_overview:"Expanding clinical operations",contact_email:"contact@acmehealth.com",contact_phone:"+1-555-0123",city:"New York",state:"NY",created_date:new Date().toISOString(),updated_date:new Date().toISOString()},{company_id:"mock-2",company_name:"MedTech Solutions",industry:"Medical Technology",company_size:"Medium",annual_revenue:"$5M-10M",company_website:"https://medtechsolutions.com",tin:"98-7654321",company_status:"prospect",lead_source:"Referral",lead_score:"Warm",expected_close_date:"2024-03-01",immediate_positions:3,annual_positions:15,opportunity_value:25e4,position_names:"Engineers, Technicians",position_type:"Technical",additional_staffing_details:"Need skilled technical staff",staffing_needs_overview:"Growing technical team",contact_email:"hr@medtechsolutions.com",contact_phone:"+1-555-0456",city:"San Francisco",state:"CA",created_date:new Date().toISOString(),updated_date:new Date().toISOString()}];if((null==e?void 0:e.status)&&(t=t.filter(t=>{var s;return t.company_status.toLowerCase()===(null==(s=e.status)?void 0:s.toLowerCase())})),null==e?void 0:e.search){let s=e.search.toLowerCase();t=t.filter(e=>{var t;return e.company_name.toLowerCase().includes(s)||(null==(t=e.industry)?void 0:t.toLowerCase().includes(s))})}return(null==e?void 0:e.limit)&&(t=t.slice(0,e.limit)),(null==e?void 0:e.offset)&&(t=t.slice(e.offset)),console.log("Mock data result:",t),t},"Failed to fetch companies")}async getCompanyById(e){return y(async()=>{let{data:t,error:s}=await x.from("companies").select("*").eq("company_id",e).single();if(s)throw s;return t},"Failed to fetch company details")}async createCompany(e){return y(async()=>{if(console.log("Creating company with data:",e),!e.company_name)throw Error("Company name is required");e.company_status||(e.company_status="lead");let t={...e};""===t.expected_close_date&&(t.expected_close_date=void 0);let s=new Date().toISOString(),a={...t,created_date:s,updated_date:s};console.log("Final company data to insert:",a);try{let{data:e,error:t}=await x.from("companies").insert([a]).select().single();if(t)throw console.error("Supabase error details:",{message:t.message,details:t.details,hint:t.hint,code:t.code,fullError:t}),Error("Database error: ".concat(t.message||"Unknown error"));return console.log("Company created successfully:",e),e}catch(e){throw console.error("Exception during company creation:",e),e}},"Failed to create company")}async updateCompany(e,t){return y(async()=>{let{data:s,error:a}=await x.from("companies").update(t).eq("company_id",e).select().single();if(a)throw a;return s},"Failed to update company")}async deleteCompany(e){return y(async()=>{let{error:t}=await x.from("companies").delete().eq("company_id",e);if(t)throw t;return!0},"Failed to delete company")}async updateCompanyStatus(e,t){return y(async()=>{let{data:s,error:a}=await x.from("companies").update({company_status:t}).eq("company_id",e).select().single();if(a)throw a;return s},"Failed to update company status")}async getCompanyAddresses(e){return y(async()=>{let{data:t,error:s}=await x.from("company_addresses").select("*").eq("company_id",e).order("created_date",{ascending:!1});if(s)throw s;return t},"Failed to fetch addresses")}async createAddress(e){return y(async()=>{let{data:t,error:s}=await x.from("company_addresses").insert([e]).select().single();if(s)throw s;return t},"Failed to create address")}async updateAddress(e,t){return y(async()=>{let{data:s,error:a}=await x.from("company_addresses").update(t).eq("address_id",e).select().single();if(a)throw a;return s},"Failed to update address")}async deleteAddress(e){return y(async()=>{let{error:t}=await x.from("company_addresses").delete().eq("address_id",e);if(t)throw t;return!0},"Failed to delete address")}async getCompanyContacts(e){return y(async()=>{let{data:t,error:s}=await x.from("dim_contact_type").select("contact_type_name, display_order").eq("is_active",!0).order("display_order");if(s)throw s;let{data:a,error:o}=await x.from("company_contacts").select("*").eq("company_id",e);if(o)throw o;return(a||[]).sort((e,s)=>{let a=null==t?void 0:t.find(t=>t.contact_type_name===e.contact_type),o=null==t?void 0:t.find(e=>e.contact_type_name===s.contact_type);return((null==a?void 0:a.display_order)||999)-((null==o?void 0:o.display_order)||999)})},"Failed to fetch contacts")}async createContact(e){return y(async()=>{let{data:t,error:s}=await x.from("company_contacts").insert([e]).select().single();if(s)throw s;return t},"Failed to create contact")}async updateContact(e,t){return y(async()=>{let{data:s,error:a}=await x.from("company_contacts").update(t).eq("contact_id",e).select().single();if(a)throw a;return s},"Failed to update contact")}async deleteContact(e){return y(async()=>{let{error:t}=await x.from("company_contacts").delete().eq("contact_id",e);if(t)throw t;return!0},"Failed to delete contact")}async getCompanyNotes(e){return y(async()=>{let{data:t,error:s}=await x.from("company_notes").select("*").eq("company_id",e).order("created_date",{ascending:!1});if(s)throw s;return t},"Failed to fetch notes")}async createNote(e){return y(async()=>{let t;if("type"in e&&"text"in e){let s=(await this.getNoteTypes()).find(t=>t.name===e.type);if(!s)throw Error("Invalid note type");t={company_id:e.company_id,note_type:e.type,note_type_id:s.id,note_text:e.text,follow_up_date:e.follow_up_date||null,follow_up_type:void 0,created_date:new Date().toISOString()}}else if((t={...e}).note_type&&!t.note_type_id){let e=(await this.getNoteTypes()).find(e=>e.name===t.note_type);e&&(t.note_type_id=e.id)}let{data:s,error:a}=await x.from("company_notes").insert([t]).select().single();if(a)throw console.error("Supabase insert error:",a),a;return s},"Failed to create note")}async deleteNote(e){return y(async()=>{let{error:t}=await x.from("company_notes").delete().eq("note_id",e);if(t)throw t;return!0},"Failed to delete note")}async getCompanyFiles(e){return y(async()=>{let{data:t,error:s}=await x.from("company_files").select("*").eq("company_id",e).order("uploaded_date",{ascending:!1});if(s)throw s;return t},"Failed to fetch files")}async uploadFile(e){return y(async()=>{let{data:t,error:s}=await x.from("company_files").insert([e]).select().single();if(s)throw s;return t},"Failed to upload file")}async deleteFile(e){return y(async()=>{let{error:t}=await x.from("company_files").delete().eq("file_id",e);if(t)throw t;return!0},"Failed to delete file")}async getStatistics(){return y(async()=>{let{data:e,error:t}=await x.from("companies").select("company_status, opportunity_value");if(t)throw t;let s={totalLeads:0,totalProspects:0,totalClients:0,totalOpportunityValue:0};return null==e||e.forEach(e=>{switch(e.company_status){case"lead":s.totalLeads++;break;case"prospect":s.totalProspects++;break;case"client":s.totalClients++}s.totalOpportunityValue+=e.opportunity_value||0}),s},"Failed to fetch statistics")}formatPhoneNumber(e){let t=e.replace(/\D/g,"");return 10===t.length?"(".concat(t.slice(0,3),") ").concat(t.slice(3,6),"-").concat(t.slice(6)):e}validateEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}validateZipCode(e){return/^\d{5}(-\d{4})?$/.test(e)}formatCurrency(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}}let g=new h;var _=s(3568),f=s(1284);function b(e){let{content:t,className:s="",buttonClassName:n=""}=e,[i,l]=(0,o.useState)(!1);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(r.$,{type:"button",variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-pink-400 hover:!text-pink-600 hover:!bg-pink-50 ".concat(n),onClick:()=>l(!i),onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:(0,a.jsx)(f.A,{className:"h-4 w-4"})}),i&&(0,a.jsxs)("div",{className:"absolute bottom-full right-0 mb-2 px-3 py-1.5 text-sm text-gray-700 rounded-md border border-pink-300 shadow-md z-50 whitespace-nowrap bg-[hsl(var(--pomera-pink))] ".concat(s),children:[t,(0,a.jsx)("div",{className:"absolute top-full right-2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-[hsl(var(--pomera-pink))]"})]})]})}var v=s(6474),j=s(3052),N=s(2525);function w(e){let{companyId:t,addresses:s,addressTypes:n,onAddressesChange:c,saving:d,isNewCompany:m=!1}=e;console.log("AddressesSection - addressTypes:",n),console.log("AddressesSection - addresses:",s),console.log("AddressesSection - address type lookup test:",n.find(e=>3===e.id));let[p,u]=(0,o.useState)({address_type_id:0,street_address:"",apt_suite:"",city:"",state:"",zip_code:""}),[x,y]=(0,o.useState)(!1),h=async()=>{if(!p.address_type_id||!p.street_address||!p.city||!p.state)return void _.oR.error("Please fill in all required fields (Address Type, Street Address, City, State)");try{if(m){let e={address_id:"temp-".concat(Date.now()),company_id:"",address_type_id:p.address_type_id,street_address:p.street_address,apt_suite:p.apt_suite,city:p.city,state:p.state,zip_code:p.zip_code,created_date:new Date().toISOString(),updated_date:new Date().toISOString()};c([...s,e]),u({address_type_id:0,street_address:"",apt_suite:"",city:"",state:"",zip_code:""}),y(!1),_.oR.success("Address added (will be saved when company is created)")}else{let e=await g.createAddress({company_id:t,...p});c([...s,e]),u({address_type_id:0,street_address:"",apt_suite:"",city:"",state:"",zip_code:""}),y(!1),_.oR.success("Address added successfully")}}catch(e){console.error("Address creation error:",e),e instanceof Error?_.oR.error("Failed to add address: ".concat(e.message)):_.oR.error("Failed to add address")}},f=async(e,t)=>{if(confirm("Are you sure you want to delete this address?"))try{m||!e.address_id||e.address_id.startsWith("temp-")||await g.deleteAddress(e.address_id),c(s.filter((e,s)=>s!==t)),_.oR.success("Address deleted successfully")}catch(e){_.oR.error("Failed to delete address")}},b=e=>{let{name:t,value:s,type:a}=e.target;u(o=>({...o,[t]:"checkbox"===a?e.target.checked:s}))},v=()=>{y(!x)};return(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsxs)(r.$,{type:"button",onClick:v,size:"sm",className:"flex items-center gap-2",children:[(0,a.jsx)(l.A,{className:"h-4 w-4"}),"Add Address"]})}),x&&(0,a.jsxs)("div",{className:"mb-4 p-4 border rounded-lg bg-gray-50",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address Type *"}),(0,a.jsxs)("select",{name:"address_type_id",value:p.address_type_id,onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select address type"}),n.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address *"}),(0,a.jsx)(i,{name:"street_address",placeholder:"123 Main Street",value:p.street_address,onChange:b,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apt/Suite"}),(0,a.jsx)(i,{name:"apt_suite",placeholder:"Apt/Suite",value:p.apt_suite,onChange:b})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City *"}),(0,a.jsx)(i,{name:"city",placeholder:"City",value:p.city,onChange:b,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State *"}),(0,a.jsxs)("select",{name:"state",value:p.state,onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:[(0,a.jsx)("option",{value:"",children:"State"}),["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Zip Code"}),(0,a.jsx)(i,{name:"zip_code",placeholder:"Zip Code",value:p.zip_code,onChange:b,pattern:"[0-9]{5}(-[0-9]{4})?"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,a.jsx)(r.$,{onClick:h,size:"sm",disabled:d,children:d?"Saving...":"Save Address"}),(0,a.jsx)(r.$,{type:"button",variant:"outline",onClick:v,size:"sm",children:"Cancel"})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:0===s.length?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No addresses added yet"}):s.map((e,t)=>(0,a.jsx)("div",{className:"border rounded p-3 bg-gray-50",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:(e=>{let t=n.find(t=>t.id===e);return console.log("Looking up address type ID ".concat(e,":"),t),t?t.name:"Type ID: ".concat(e)})(e.address_type_id)})}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[e.street_address,e.apt_suite&&", ".concat(e.apt_suite),e.city&&", ".concat(e.city),e.state&&", ".concat(e.state),e.zip_code&&" ".concat(e.zip_code)]})]}),(0,a.jsx)("button",{onClick:()=>f(e,t),className:"text-red-500 hover:text-red-700",disabled:d,children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})]})},e.address_id||t))})]})}let C=e=>{let{className:t="h-5 w-5"}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("rect",{x:"12",y:"8",width:"10",height:"14",rx:"1",ry:"1"}),(0,a.jsx)("rect",{x:"13",y:"9",width:"8",height:"3",rx:"0.5",fill:"white"}),(0,a.jsx)("rect",{x:"13",y:"13",width:"8",height:"8",rx:"0.5"}),(0,a.jsx)("rect",{x:"13.5",y:"13.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"15.5",y:"13.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"17.5",y:"13.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"13.5",y:"15.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"15.5",y:"15.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"17.5",y:"15.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"13.5",y:"17.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"15.5",y:"17.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"17.5",y:"17.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"13.5",y:"19.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"15.5",y:"19.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("rect",{x:"17.5",y:"19.5",width:"1.5",height:"1.5",fill:"currentColor"}),(0,a.jsx)("path",{d:"M2 10 C2 8, 4 6, 8 6 L10 6 C12 6, 14 8, 14 10 L14 12 C14 14, 12 16, 10 16 L8 16 C4 16, 2 14, 2 12 Z"}),(0,a.jsx)("path",{d:"M8 6 Q6 8, 8 10 Q10 12, 8 14 Q6 16, 8 18 Q10 20, 12 20",strokeWidth:"1.5"})]})},k=e=>{let{className:t="h-5 w-5"}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2",fill:"black"}),(0,a.jsx)("rect",{x:"6",y:"4",width:"12",height:"16",rx:"1",ry:"1",fill:"white"}),(0,a.jsx)("line",{x1:"12",y1:"3",x2:"12",y2:"3.5",stroke:"white",strokeWidth:"2"}),(0,a.jsx)("circle",{cx:"12",cy:"20",r:"1",fill:"white"})]})};function S(e){let{companyId:t,contacts:s,contactTypes:n,contactMethods:c,onContactsChange:d,saving:m,isNewCompany:p=!1}=e,[u,x]=(0,o.useState)({contact_type:"",contact_first_name:"",contact_last_name:"",contact_job_title:"",contact_email:"",contact_phone:"",contact_mobile:"",preferred_contact_method:"email"}),[y,h]=(0,o.useState)(!1),f=e=>{if(!e)return!0;let t=e.replace(/\D/g,"");return 10===t.length||11===t.length},b=async()=>{if(!u.contact_type||!u.contact_first_name||!u.contact_last_name)return void _.oR.error("Please fill in all required fields (Contact Type, First Name, Last Name)");if(u.contact_phone&&!f(u.contact_phone))return void _.oR.error("Work phone must be a valid 10-digit phone number");if(u.contact_mobile&&!f(u.contact_mobile))return void _.oR.error("Mobile phone must be a valid 10-digit phone number");try{if(p){let e={contact_id:"temp-".concat(Date.now()),company_id:"",contact_type:u.contact_type,contact_first_name:u.contact_first_name,contact_last_name:u.contact_last_name,contact_job_title:u.contact_job_title,contact_email:u.contact_email||"",contact_phone:u.contact_phone,contact_mobile:u.contact_mobile,preferred_contact_method:u.preferred_contact_method||"email",is_active:!0,created_date:new Date().toISOString(),updated_date:new Date().toISOString()};d([...s,e]),x({contact_type:"",contact_first_name:"",contact_last_name:"",contact_job_title:"",contact_email:"",contact_phone:"",contact_mobile:"",preferred_contact_method:"email"}),h(!1),_.oR.success("Contact added (will be saved when company is created)")}else{let e=await g.createContact({company_id:t,...u});d([...s,e]),x({contact_type:"",contact_first_name:"",contact_last_name:"",contact_job_title:"",contact_email:"",contact_phone:"",contact_mobile:"",preferred_contact_method:"email"}),h(!1),_.oR.success("Contact added successfully")}}catch(e){console.error("Contact creation error:",e),e instanceof Error?_.oR.error("Failed to add contact: ".concat(e.message)):_.oR.error("Failed to add contact")}},v=async(e,t)=>{if(confirm("Are you sure you want to delete this contact?"))try{p||!e.contact_id||e.contact_id.startsWith("temp-")||await g.deleteContact(e.contact_id),d(s.filter((e,s)=>s!==t)),_.oR.success("Contact deleted successfully")}catch(e){_.oR.error("Failed to delete contact")}},j=e=>{let{name:t,value:s,type:a}=e.target;if("contact_phone"===t||"contact_mobile"===t){let e=s.replace(/\D/g,""),a="";e.length>0&&(a=e.length<=3?"(".concat(e):e.length<=6?"(".concat(e.slice(0,3),") ").concat(e.slice(3)):"(".concat(e.slice(0,3),") ").concat(e.slice(3,6),"-").concat(e.slice(6,10))),x(e=>({...e,[t]:a}))}else x(o=>({...o,[t]:"checkbox"===a?e.target.checked:s}))},w=()=>{h(!y)};return(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsxs)(r.$,{type:"button",onClick:w,size:"sm",className:"flex items-center gap-2",children:[(0,a.jsx)(l.A,{className:"h-4 w-4"}),"Add Contact"]})}),y&&(0,a.jsxs)("div",{className:"mb-4 p-4 border rounded-lg bg-gray-50",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Type *"}),(0,a.jsxs)("select",{name:"contact_type",value:u.contact_type,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select contact type"}),n.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsx)(i,{name:"contact_first_name",placeholder:"First Name *",value:u.contact_first_name,onChange:j,required:!0}),(0,a.jsx)(i,{name:"contact_last_name",placeholder:"Last Name *",value:u.contact_last_name,onChange:j,required:!0}),(0,a.jsx)(i,{name:"contact_job_title",placeholder:"Job Title",value:u.contact_job_title,onChange:j}),(0,a.jsx)(i,{name:"contact_email",type:"email",placeholder:"Email",value:u.contact_email,onChange:j}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)(i,{name:"contact_phone",placeholder:"Work Phone",value:u.contact_phone,onChange:j,className:"flex-1"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(k,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)(i,{name:"contact_mobile",placeholder:"Mobile Phone",value:u.contact_mobile,onChange:j,className:"flex-1"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Contact Method"}),(0,a.jsxs)("select",{name:"preferred_contact_method",value:u.preferred_contact_method,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Select method"}),c.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,a.jsx)(r.$,{onClick:b,size:"sm",disabled:m,children:m?"Saving...":"Save Contact"}),(0,a.jsx)(r.$,{type:"button",variant:"outline",onClick:w,size:"sm",children:"Cancel"})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:0===s.length?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No contacts added yet"}):s.map((e,t)=>(0,a.jsx)("div",{className:"border rounded p-3 bg-gray-50",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.contact_type}),e.is_primary_contact&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full",children:"Primary"}),e.is_decision_maker&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full",children:"Decision Maker"}),!e.is_active&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-800 rounded-full",children:"Inactive"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mb-1",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.contact_first_name," ",e.contact_last_name]}),e.contact_job_title&&" - ".concat(e.contact_job_title)]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,a.jsx)("div",{children:e.contact_email}),e.contact_phone&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(C,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:e.contact_phone}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"(work)"})]}),e.contact_mobile&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(k,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:e.contact_mobile}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"(mobile)"})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:["Preferred: ",e.preferred_contact_method]})]})]}),(0,a.jsx)("button",{onClick:()=>v(e,t),className:"text-red-500 hover:text-red-700",disabled:m,children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})]})},e.contact_id||t))})]})}function A(e){let t,{dimensions:s,onSuccess:n,onCancel:l,initialData:c={},isEditMode:d=!1}=e,[m,p]=(0,o.useState)(!1),[u,x]=(0,o.useState)([]),[y,h]=(0,o.useState)([]),[f,N]=(0,o.useState)({companyInfo:!0,address:!1,primaryContact:!1,leadData:!1,staffingNeeds:!1}),[C,k]=(0,o.useState)({company_name:"",industry:"",company_size:"",annual_revenue:"",company_website:"",tin:"",company_status:"",lead_source:"",lead_score:"",expected_close_date:"",opportunity_value:0,staffing_needs_overview:"",immediate_positions:0,annual_positions:0,position_type:"",additional_staffing_details:"",...c}),A=e=>{console.log("Toggling section:",e),N(t=>{let s={...t,[e]:!t[e]};return console.log("New expanded state:",s),s})},D=e=>!e||e.match(/^https?:\/\//)?e:e.match(/^www\./)||e.match(/^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\.[a-zA-Z]{2,}$/)?"https://".concat(e):e,L=e=>{let{name:t,value:s,type:a}=e.target;k(e=>({...e,[t]:"number"===a?""===s?0:Number(s):s}))},F=async e=>{if(e.preventDefault(),C.company_name||(_.oR.error("Company name is required"),0)){p(!0);try{let e,t={...C,company_website:C.company_website?D(C.company_website):C.company_website};if(console.log("Submitting company data:",t),e=d&&c.company_id?await g.updateCompany(c.company_id,t):await g.createCompany(t),console.log("Company creation result:",e),e&&e.company_id){if(!d&&e.company_id){if(console.log("Saving addresses and contacts for new company:",e.company_id),console.log("Addresses to save:",u),console.log("Contacts to save:",y),u.length>0)for(let t of u)try{let{address_id:s,...a}=t;console.log("Saving address:",a);let o=await g.createAddress({...a,company_id:e.company_id});console.log("Address saved successfully:",o)}catch(e){console.error("Error saving address:",e),_.oR.error("Some addresses could not be saved")}if(y.length>0)for(let t of y)try{let{contact_id:s,...a}=t;console.log("Saving contact:",a);let o=await g.createContact({...a,company_id:e.company_id});console.log("Contact saved successfully:",o)}catch(e){console.error("Error saving contact:",e),_.oR.error("Some contacts could not be saved")}}_.oR.success(d?"Company updated successfully!":"Company added successfully!"),n(e)}}catch(e){console.error("Error saving company:",e),_.oR.error("Failed to save company")}finally{p(!1)}}};return(0,a.jsxs)("div",{className:"p-6 border-b bg-gray-50",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:d?"Edit Company":"Add New Company"}),(0,a.jsxs)("form",{onSubmit:F,children:[(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>A("companyInfo"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Company Information"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),f.companyInfo?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),f.companyInfo&&(0,a.jsx)("div",{className:"p-4 space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name *"}),(0,a.jsx)(i,{name:"company_name",value:C.company_name,onChange:L,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Industry"}),(0,a.jsxs)("select",{name:"industry",value:C.industry,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Select industry"}),s.industries.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Size"}),(0,a.jsxs)("select",{name:"company_size",value:C.company_size,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Select size"}),s.sizes.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Revenue"}),(0,a.jsxs)("select",{name:"annual_revenue",value:C.annual_revenue,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Select revenue"}),s.revenues.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TIN (Tax ID)"}),(0,a.jsx)(i,{name:"tin",value:C.tin,onChange:L,placeholder:"XX-XXXXXXX"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),(0,a.jsx)(i,{name:"company_website",value:C.company_website,onChange:L,type:"text",placeholder:"www.example.com or https://example.com"}),C.company_website&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Will be saved as: ",D(C.company_website)]})]})]})})]}),(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>A("address"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Addresses/Locations"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),f.address?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),f.address&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(w,{companyId:d&&c.company_id?c.company_id:"",addresses:u,addressTypes:s.addressTypes,onAddressesChange:x,saving:m,isNewCompany:!d})})]}),(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>A("primaryContact"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Contacts"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),f.primaryContact?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),f.primaryContact&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(S,{companyId:d&&c.company_id?c.company_id:"",contacts:y,contactTypes:s.contactTypes,contactMethods:s.contactMethods,onContactsChange:h,saving:m,isNewCompany:!d})})]}),(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>A("leadData"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Lead Data"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),f.leadData?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),f.leadData&&(0,a.jsx)("div",{className:"p-4 space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lead Source"}),(0,a.jsxs)("select",{name:"lead_source",value:C.lead_source,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Select source"}),s.sources.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lead Score"}),(0,a.jsxs)("select",{name:"lead_score",value:C.lead_score,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Select lead score"}),s.scores.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Close Date"}),(0,a.jsx)(i,{name:"expected_close_date",type:"date",value:C.expected_close_date,onChange:L})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-start gap-2 mb-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700 mt-0.5",children:"Opportunity Value"}),(0,a.jsx)(b,{content:"Enter amount in USD, ex: 5,000"})]}),(0,a.jsx)(i,{name:"opportunity_value",type:"text",value:0===C.opportunity_value?"":(t=C.opportunity_value,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)),onChange:e=>{let t=e.target.value.replace(/[$,]/g,""),s=""===t?0:parseInt(t,10);!isNaN(s)&&s>=0&&k(e=>({...e,opportunity_value:s}))},placeholder:"Estimated Opportunity Size"})]})]})})]}),(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>A("staffingNeeds"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Staffing Needs"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),f.staffingNeeds?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),f.staffingNeeds&&(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Staffing Needs Overview"}),(0,a.jsx)("textarea",{name:"staffing_needs_overview",value:C.staffing_needs_overview,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:3,placeholder:"Describe the overall staffing needs..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Immediate Positions"}),(0,a.jsx)(i,{name:"immediate_positions",type:"number",value:C.immediate_positions,onChange:L,min:"0",placeholder:"0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Positions"}),(0,a.jsx)(i,{name:"annual_positions",type:"number",value:C.annual_positions,onChange:L,min:"0",placeholder:"0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Position Type"}),(0,a.jsxs)("select",{name:"position_type",value:C.position_type,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Select type"}),s.positionTypes.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Staffing Details"}),(0,a.jsx)("textarea",{name:"additional_staffing_details",value:C.additional_staffing_details,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:3,placeholder:"Any additional details about staffing requirements..."})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.$,{type:"submit",disabled:m,children:m?"Saving...":d?"Update Company":"Save Company"}),(0,a.jsx)(r.$,{type:"button",variant:"outline",onClick:l,children:"Cancel"})]})]})]})}var D=s(8883),L=s(9420),F=s(4516),T=s(2657),I=s(3717);function M(e){let{companies:t,loading:s,activeTab:o,onViewLead:n,onEditLead:i,dimensions:l}=e;return s?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):0===t.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:["No ",o," found. Add your first company to get started."]}):(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>{var t;let s;return(0,a.jsx)("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:e.company_name}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{let t=l.statuses.find(t=>t.name.toLowerCase()===(null==e?void 0:e.toLowerCase())||t.name.toLowerCase().includes((null==e?void 0:e.toLowerCase())||"")||(null==e?void 0:e.toLowerCase().includes(t.name.toLowerCase())));return(null==t?void 0:t.color)&&({red:"bg-red-100 text-red-800",orange:"bg-orange-100 text-orange-800",blue:"bg-blue-100 text-blue-800",green:"bg-green-100 text-green-800",yellow:"bg-yellow-100 text-yellow-800",purple:"bg-purple-100 text-purple-800",pink:"bg-pink-100 text-pink-800",grey:"bg-gray-100 text-gray-800",gray:"bg-gray-100 text-gray-800",black:"bg-black text-white",white:"bg-white text-black"})[t.color.toLowerCase()]||"bg-gray-100 text-gray-800"})(e.company_status)),children:e.company_status}),e.lead_score&&(0,a.jsx)("span",{className:"text-sm font-medium ".concat((e=>{let t=l.scores.find(t=>t.name.toLowerCase()===(null==e?void 0:e.toLowerCase())||t.name.toLowerCase().includes((null==e?void 0:e.toLowerCase())||"")||(null==e?void 0:e.toLowerCase().includes(t.name.toLowerCase())));return(null==t?void 0:t.color)&&({red:"text-red-600",orange:"text-orange-600",blue:"text-blue-600",green:"text-green-600",yellow:"text-yellow-600",purple:"text-purple-600",pink:"text-pink-600",grey:"text-gray-600",gray:"text-gray-600",black:"text-black",white:"text-white"})[t.color.toLowerCase()]||"text-gray-600"})(e.lead_score)),children:(null==(t=l.scores.find(t=>{var s,a,o;return t.name.toLowerCase()===(null==(s=e.lead_score)?void 0:s.toLowerCase())||t.name.toLowerCase().includes((null==(a=e.lead_score)?void 0:a.toLowerCase())||"")||(null==(o=e.lead_score)?void 0:o.toLowerCase().includes(t.name.toLowerCase()))}))?void 0:t.name)||e.lead_score})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(D.A,{className:"h-4 w-4 mr-2"}),e.contact_email||"No email"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(L.A,{className:"h-4 w-4 mr-2"}),e.contact_phone||"No phone"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(F.A,{className:"h-4 w-4 mr-2"}),e.city&&e.state?"".concat(e.city,", ").concat(e.state):"No location"]})]}),e.opportunity_value&&e.opportunity_value>0&&(0,a.jsxs)("p",{className:"mt-2 text-sm font-medium text-green-600",children:["Opportunity: ",(s=e.opportunity_value,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s))]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>n(e),children:(0,a.jsx)(T.A,{className:"h-4 w-4"})}),(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>i(e),children:(0,a.jsx)(I.A,{className:"h-4 w-4"})})]})]})},e.company_id)})})}var z=s(9869);function R(e){let{companyId:t,notes:s,noteTypes:n,contactMethods:l,onNotesChange:c,saving:d,readOnly:m=!1,onNoteSaved:p}=e,[u,x]=(0,o.useState)({type:"",text:"",followUpDate:"",followUpType:""}),y=async()=>{if(!u.type||!u.text)return void _.oR.error("Please select a type and enter a note");if(u.followUpDate&&new Date(u.followUpDate)<new Date(new Date().setHours(0,0,0,0)))return void _.oR.error("Follow-up date cannot be in the past");try{let e=await g.createNote({company_id:t,type:u.type,text:u.text,follow_up_date:u.followUpDate||void 0});c([...s,e]),x({type:"",text:"",followUpDate:"",followUpType:""}),_.oR.success("Note added"),p&&p()}catch(e){console.error("Note creation error:",e),e instanceof Error?_.oR.error("Failed to add note: ".concat(e.message)):_.oR.error("Failed to add note")}},h=async(e,t)=>{if(confirm("Are you sure you want to delete this note?"))try{e.note_id&&await g.deleteNote(e.note_id),c(s.filter((e,s)=>s!==t)),_.oR.success("Note deleted")}catch(e){_.oR.error("Failed to delete note")}};return(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Notes & Activities"}),!m&&(0,a.jsxs)("div",{className:"mb-4 space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Note/Activity Type"}),(0,a.jsxs)("select",{value:u.type,onChange:e=>x({...u,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Select note type"}),n.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Comments"}),(0,a.jsx)("textarea",{placeholder:"Add a note...",value:u.text,onChange:e=>x({...u,text:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md min-h-[80px] resize-y",rows:3})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Follow-Up Date"}),(0,a.jsx)(i,{type:"date",value:u.followUpDate,onChange:e=>x({...u,followUpDate:e.target.value}),min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Follow-Up Method"}),(0,a.jsxs)("select",{value:u.followUpType,onChange:e=>x({...u,followUpType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Select method"}),l.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,a.jsx)(r.$,{onClick:y,size:"sm",disabled:d,className:"w-full",children:d?"Saving...":"Save"})]}),(0,a.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:0===s.length?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No notes yet"}):s.map((e,t)=>(0,a.jsx)("div",{className:"border rounded p-3 bg-gray-50",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.note_type||e.type}),e.follow_up_date&&(0,a.jsxs)("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full",children:["Follow-up: ",new Date(e.follow_up_date).toLocaleDateString(),e.follow_up_type&&" (".concat(e.follow_up_type,")")]})]}),(0,a.jsx)("p",{className:"text-sm mt-1",children:e.note_text||e.text}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.created_date||e.date).toLocaleString()})]}),!m&&(0,a.jsx)("button",{onClick:()=>h(e,t),className:"text-red-500 hover:text-red-700",disabled:d,children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})]})},e.note_id||t))})]})}function E(e){var t;let s,{company:n,onClose:i,dimensions:l,notes:c,contacts:d,addresses:m,onNotesChange:p,onContactsChange:u,onAddressesChange:x,onStatusChange:y,saving:h}=e,[g,f]=(0,o.useState)({companyInfo:!1,address:!1,primaryContact:!1,leadData:!1,staffingNeeds:!1,notes:!1,uploads:!1}),[b,N]=(0,o.useState)(!1),[C,k]=(0,o.useState)(!1),[A,D]=(0,o.useState)(""),L=e=>{f(t=>({...t,[e]:!t[e]}))};return(0,a.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("div",{className:"p-6 border-b sticky top-0 bg-white z-10",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:n.company_name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Status:"}),(0,a.jsxs)("select",{value:n.company_status,onChange:e=>y(e.target.value),className:"px-2 py-1 text-sm border border-gray-300 rounded",children:[(0,a.jsx)("option",{value:"lead",children:"Lead"}),(0,a.jsx)("option",{value:"prospect",children:"Prospect"}),(0,a.jsx)("option",{value:"client",children:"Client"}),(0,a.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.$,{size:"sm",onClick:()=>N(!0),children:"+ Add Note/Activity"}),(0,a.jsxs)(r.$,{size:"sm",variant:"outline",onClick:()=>k(!0),children:[(0,a.jsx)(z.A,{className:"h-4 w-4 mr-2"}),"Upload File"]}),(0,a.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 text-3xl ml-2",children:"\xd7"})]})]})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>L("companyInfo"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Company Information"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),g.companyInfo?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),g.companyInfo&&(0,a.jsx)("div",{className:"p-4 space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Company Name"}),(0,a.jsx)("p",{className:"font-medium",children:n.company_name||"Not specified"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Industry"}),(0,a.jsx)("p",{className:"font-medium",children:n.industry||"Not specified"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Company Size"}),(0,a.jsx)("p",{className:"font-medium",children:n.company_size||"Not specified"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Annual Revenue"}),(0,a.jsx)("p",{className:"font-medium",children:n.annual_revenue||"Not specified"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"TIN (Tax ID)"}),(0,a.jsx)("p",{className:"font-medium",children:n.tin||"Not specified"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Website"}),(0,a.jsx)("p",{className:"font-medium",children:n.company_website||"Not provided"})]})]})})]}),(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>L("address"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Addresses/Locations"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),g.address?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),g.address&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(w,{companyId:n.company_id,addresses:m,addressTypes:l.addressTypes,onAddressesChange:x,saving:h,isNewCompany:!1})})]}),(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>L("primaryContact"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Contacts"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),g.primaryContact?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),g.primaryContact&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(S,{companyId:n.company_id,contacts:d,contactTypes:l.contactTypes,contactMethods:l.contactMethods,onContactsChange:u,saving:h,isNewCompany:!1})})]}),(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>L("leadData"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Lead Data"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),g.leadData?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),g.leadData&&(0,a.jsx)("div",{className:"p-4 space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Lead Source"}),(0,a.jsx)("p",{className:"font-medium",children:n.lead_source||"Not specified"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Lead Score"}),(0,a.jsx)("p",{className:"font-medium",children:n.lead_score?(null==(t=l.scores.find(e=>{var t,s,a;return e.name.toLowerCase()===(null==(t=n.lead_score)?void 0:t.toLowerCase())||e.name.toLowerCase().includes((null==(s=n.lead_score)?void 0:s.toLowerCase())||"")||(null==(a=n.lead_score)?void 0:a.toLowerCase().includes(e.name.toLowerCase()))}))?void 0:t.name)||n.lead_score:"Not specified"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Expected Close Date"}),(0,a.jsx)("p",{className:"font-medium",children:n.expected_close_date||"Not specified"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Opportunity Value"}),(0,a.jsx)("p",{className:"font-medium",children:n.opportunity_value?(s=n.opportunity_value,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)):"Not specified"})]})]})})]}),(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>L("staffingNeeds"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Staffing Needs"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),g.staffingNeeds?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),g.staffingNeeds&&(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Staffing Needs Overview"}),(0,a.jsx)("p",{className:"font-medium",children:n.staffing_needs_overview||"Not provided"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Immediate Positions"}),(0,a.jsx)("p",{className:"font-medium",children:n.immediate_positions||0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Annual Positions"}),(0,a.jsx)("p",{className:"font-medium",children:n.annual_positions||0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Position Type"}),(0,a.jsx)("p",{className:"font-medium",children:n.position_type||"Not specified"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Additional Staffing Details"}),(0,a.jsx)("p",{className:"font-medium",children:n.additional_staffing_details||"Not provided"})]})]})]}),(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>L("notes"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Notes & Activities"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),g.notes?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),g.notes&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(R,{companyId:n.company_id,notes:c,noteTypes:l.noteTypes,contactMethods:l.contactMethods,onNotesChange:p,saving:h,readOnly:!0})})]}),(0,a.jsxs)("div",{className:"mb-6 border rounded-lg",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>L("uploads"),className:"w-full px-4 py-3 text-left bg-gray-100 hover:bg-gray-200 flex items-center justify-between rounded-t-lg cursor-pointer transition-colors border border-gray-200 hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Documents & Files"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(click to expand/collapse)"})]}),g.uploads?(0,a.jsx)(v.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})]}),g.uploads&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No files uploaded yet"})})]}),(0,a.jsx)("div",{className:"flex gap-2 pt-4 border-t",children:(0,a.jsx)(r.$,{variant:"outline",onClick:i,children:"Close"})})]})]}),b&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[100] flex items-start justify-center p-4 pt-20",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsx)("div",{className:"p-6 border-b sticky top-0 bg-white",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Add Note/Activity"}),(0,a.jsx)("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(R,{companyId:n.company_id,notes:c,noteTypes:l.noteTypes,contactMethods:l.contactMethods,onNotesChange:p,saving:h,readOnly:!1,onNoteSaved:()=>N(!1)})})]})}),C&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[100] flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[(0,a.jsx)("div",{className:"p-6 border-b",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Upload File"}),(0,a.jsx)("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Document Type"}),(0,a.jsxs)("select",{value:A,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Select document type"}),l.documentTypes.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)(r.$,{onClick:()=>{if(!A)return void _.oR.error("Please select a document type");_.oR.success("File upload functionality coming soon for ".concat(A)),k(!1),D("")},disabled:!A,children:[(0,a.jsx)(z.A,{className:"h-4 w-4 mr-2"}),"Upload File"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"File upload functionality coming soon"})]})]})})]})})]})}var U=s(8998);function O(){console.log("=== CRM COMPONENT MOUNTING ===");let[e,t]=(0,o.useState)([]),[s,n]=(0,o.useState)({statuses:[],sources:[],scores:[],sizes:[],revenues:[],positionTypes:[],noteTypes:[],contactMethods:[],contactTypes:[],addressTypes:[],fileCategories:[],industries:[],documentTypes:[]}),[m,p]=(0,o.useState)(!0),[u,x]=(0,o.useState)(!1),[y,h]=(0,o.useState)(""),[f,b]=(0,o.useState)(!1),[v,j]=(0,o.useState)(null),[N,w]=(0,o.useState)(!1),[C,k]=(0,o.useState)(""),[S,D]=(0,o.useState)([]),[L,F]=(0,o.useState)([]),[T,I]=(0,o.useState)([]);(0,o.useEffect)(()=>{console.log("=== USE_EFFECT TRIGGERED ==="),z()},[]);let z=async()=>{p(!0);try{console.log("=== DEBUGGING COMPANIES LOADING ===");let e=await g.getCompanies();console.log("Raw companiesResult:",e),console.log("Type of companiesResult:",typeof e),console.log("companiesResult length:",null==e?void 0:e.length),e?(console.log("Setting companies with data:",e),t(e)):(console.log("No companies data, setting empty array"),t([]));try{console.log("Starting to load dimensions...");let[e,t,s,a,o,r,i,l,c,d,m,p,u]=await Promise.all([g.getDimensions("dim_company_status"),g.getDimensions("dim_lead_source"),g.getDimensions("dim_lead_score"),g.getDimensions("dim_company_size"),g.getDimensions("dim_annual_revenue"),g.getDimensions("dim_position_type"),g.getDimensions("dim_note_type"),g.getDimensions("dim_contact_method"),g.getDimensions("dim_contact_type"),g.getDimensions("dim_address_type"),g.getDimensions("dim_file_category"),g.getDimensions("dim_industry"),g.getDocumentTypes()]);console.log("All dimensions loaded successfully"),console.log("Document types loaded:",u),n({statuses:e||[],sources:t||[],scores:s||[],sizes:a||[],revenues:o||[],positionTypes:r||[],noteTypes:i||[],contactMethods:l||[],contactTypes:c||[],addressTypes:d||[],fileCategories:m||[],industries:p||[],documentTypes:u||[]}),!y&&e&&e.length>0&&h(e[0].name.toLowerCase())}catch(e){console.error("Error loading dimensions:",e),console.error("Error details:",e),_.oR.error("Failed to load some dimension data")}}catch(e){console.error("Error loading data:",e),_.oR.error("Failed to load data")}finally{p(!1)}},R=async()=>{try{let e=await g.getCompanies();e&&t(e)}catch(e){console.error("Error loading companies:",e)}},O=async e=>{try{let t=await g.getCompanyNotes(e);t&&D(t)}catch(e){console.error("Error loading notes:",e)}},P=async e=>{try{let t=await g.getCompanyAddresses(e);t&&I(t)}catch(e){console.error("Error loading addresses:",e)}},$=async e=>{try{let t=await g.getCompanyContacts(e);t&&F(t)}catch(e){console.error("Error loading contacts:",e)}},q=async e=>{b(!1),await R(),_.oR.success("Company added successfully!")},W=async e=>{j(e),w(!1),await Promise.all([O(e.company_id),P(e.company_id),$(e.company_id)])},X=async e=>{j(e),w(!0),await Promise.all([O(e.company_id),P(e.company_id),$(e.company_id)])},Z=async e=>{if(v)try{await g.updateCompanyStatus(v.company_id,e)&&(j({...v,company_status:e}),await R(),_.oR.success("Status updated successfully"))}catch(e){_.oR.error("Failed to update status")}},G=e.length>0?e.filter(e=>{var t,a,o;let r=s.statuses.some(t=>{var s,a,o;return t.name.toLowerCase()===y&&((null==(s=e.company_status)?void 0:s.toLowerCase())===t.name.toLowerCase()||(null==(a=e.company_status)?void 0:a.toLowerCase().includes(t.name.toLowerCase()))||t.name.toLowerCase().includes((null==(o=e.company_status)?void 0:o.toLowerCase())||""))}),n=(null==(t=e.company_name)?void 0:t.toLowerCase().includes(C.toLowerCase()))||(null==(a=e.industry)?void 0:a.toLowerCase().includes(C.toLowerCase()))||(null==(o=e.contact_email)?void 0:o.toLowerCase().includes(C.toLowerCase()));return r&&(""===C||n)}):[];return console.log("=== FILTERING DEBUG ==="),console.log("Total companies:",e.length),console.log("Active tab:",y),console.log("Search term:",C),console.log("Filtered companies:",G.length),console.log("Sample company statuses:",e.map(e=>e.company_status)),console.log("Sample company names:",e.map(e=>e.company_name)),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(U.A,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:s.statuses.slice(0,3).map((t,s)=>{var o,r;let n=e.filter(e=>{var s,a,o;return(null==(s=e.company_status)?void 0:s.toLowerCase())===t.name.toLowerCase()||(null==(a=e.company_status)?void 0:a.toLowerCase().includes(t.name.toLowerCase()))||t.name.toLowerCase().includes((null==(o=e.company_status)?void 0:o.toLowerCase())||"")}).length,i=[{bg:"bg-blue-100",text:"text-blue-600"},{bg:"bg-yellow-100",text:"text-yellow-600"},{bg:"bg-green-100",text:"text-green-600"}],l=[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},"users"),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},"check"),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"},"star")];return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 ".concat((null==(o=i[s])?void 0:o.bg)||"bg-gray-100"," rounded-lg"),children:(0,a.jsx)("svg",{className:"w-6 h-6 ".concat((null==(r=i[s])?void 0:r.text)||"text-gray-600"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l[s]})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-600",children:["Total ",t.name,"s"]}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:n})]})]})},t.name)})}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:s.statuses.map(e=>(0,a.jsx)("button",{onClick:()=>h(e.name.toLowerCase()),className:"py-2 px-1 border-b-2 font-medium text-sm capitalize ".concat(y===e.name.toLowerCase()?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.name},e.name))})})}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6 gap-4",children:[(0,a.jsxs)(r.$,{onClick:()=>b(!0),children:[(0,a.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"Add Company"]}),(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(c.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,a.jsx)(i,{placeholder:"Search companies...",value:C,onChange:e=>k(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Filter & Sort"]})]}),f&&(0,a.jsx)(A,{dimensions:s,onSuccess:q,onCancel:()=>b(!1)}),(0,a.jsx)(M,{companies:G,loading:m,activeTab:y,onViewLead:W,onEditLead:X,dimensions:s}),v&&(0,a.jsx)(E,{company:v,onClose:()=>{j(null),w(!1),D([]),F([]),I([])},dimensions:s,notes:S,contacts:L,addresses:T,onNotesChange:D,onContactsChange:F,onAddressesChange:I,onStatusChange:Z,saving:u})]})]})}},3999:(e,t,s)=>{"use strict";s.d(t,{cn:()=>r});var a=s(2596),o=s(9688);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.QP)((0,a.$)(t))}},5077:(e,t,s)=>{Promise.resolve().then(s.bind(s,958))},7168:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var a=s(5155),o=s(2115),r=s(4624),n=s(2085),i=s(3999);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=o.forwardRef((e,t)=>{let{className:s,variant:o,size:n,asChild:c=!1,...d}=e,m=c?r.DX:"button";return(0,a.jsx)(m,{className:(0,i.cn)(l({variant:o,size:n,className:s})),ref:t,...d})});c.displayName="Button"},8998:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var a=s(5155),o=s(2115),r=s(5695),n=s(7168),i=s(4416),l=s(4783);let c=()=>{let[e,t]=(0,o.useState)(!1),s=(0,r.usePathname)(),c=[{label:"Client (CRM)",href:"/crm"},{label:"ATS",href:"/ats"},{label:"Pomera Admin",href:"/admin"}],d=e=>"/crm"===e?"/crm"===s:"/ats"===e?"/ats"===s||s.startsWith("/ats/"):"/admin"===e&&("/admin"===s||s.startsWith("/admin/"));return(0,a.jsx)("header",{className:"bg-background/95 backdrop-blur-sm border-b border-border z-50",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsxs)("div",{className:"flex items-center h-16",children:[(0,a.jsx)("div",{className:"flex items-center pl-24",children:(0,a.jsx)("a",{href:"/",className:"flex items-center",children:(0,a.jsx)("img",{src:"/pomera_logo_cropped.png",alt:"Pomera Care Logo",className:"h-12 w-auto"})})}),(0,a.jsxs)("nav",{className:"hidden md:flex items-center space-x-8 ml-auto",children:[c.map(e=>(0,a.jsx)("a",{href:e.href,className:"py-2 px-4 rounded-lg font-medium text-sm transition-colors duration-200 ".concat(d(e.href)?"bg-primary text-primary-foreground":"text-foreground hover:text-primary hover:bg-gray-100"),children:e.label},e.href)),(0,a.jsx)(n.$,{variant:"outline",className:"ml-4",children:"Logout"})]}),(0,a.jsx)("button",{className:"md:hidden",onClick:()=>t(!e),children:e?(0,a.jsx)(i.A,{className:"h-6 w-6 text-foreground"}):(0,a.jsx)(l.A,{className:"h-6 w-6 text-foreground"})})]}),e&&(0,a.jsxs)("div",{className:"md:hidden border-t border-border mt-2 py-4 space-y-4",children:[c.map(e=>(0,a.jsx)("a",{href:e.href,className:"block py-2 px-4 rounded-lg font-medium text-sm transition-colors duration-200 ".concat(d(e.href)?"bg-primary text-primary-foreground":"text-foreground hover:text-primary hover:bg-gray-100"),onClick:()=>t(!1),children:e.label},e.href)),(0,a.jsx)(n.$,{variant:"outline",className:"w-full mt-4",children:"Logout"})]})]})})}}},e=>{e.O(0,[609,489,441,964,358],()=>e(e.s=5077)),_N_E=e.O()}]);